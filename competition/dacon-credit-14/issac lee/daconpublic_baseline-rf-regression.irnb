{
    "cells": [
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# [ìŠ¬ê¸°ë¡œìš´ í†µê³„ìƒí™œ](https://www.youtube.com/c/statisticsplaybook) at DACON!\n",
                "\n",
                "ì•ˆë…•í•˜ì„¸ìš”~! R ì‚¬ìš©ìë“¤ì˜ ë°ì´í„° ê²½ì§„ëŒ€íšŒ ì°¸ì—¬ìœ¨ì„ ë†’ì´ê¸° ìœ„í•´ì„œ baseline ì½”ë“œ ê³µê°œí•©ë‹ˆë‹¤. ìš”ì¦˜ í•«í•œ Tidymodelsë¥¼ ì‚¬ìš©í•´ì„œ ì›”ê°„ ë°ì´ì½˜ 14 - ì‹ ìš©ì¹´ë“œ ì‚¬ìš©ì ì—°ì²´ ì˜ˆì¸¡ AI ê²½ì§„ëŒ€íšŒ ë² ì´ìŠ¤ë¼ì¸ì„ ì¡ì•„ë³´ë„ë¡ í•©ì‹œë‹¤.\n",
                "\n",
                "[ìŠ¬í†µ ìºê¸€ R ìŠ¤í„°ë””](https://www.youtube.com/playlist?list=PLKtLBdGREmMlJCXjCpCi5B4KQ-TsFvAAi)ì—ë„ ë§ì€ ê´€ì‹¬ ë¶€íƒë“œë¦½ë‹ˆë‹¤! Rìœ ì € í™”ì´íŒ…~! ğŸ˜\n",
                "\n",
                "# ì¤€ë¹„ì‘ì—…\n",
                "\n",
                "## íŒ¨í‚¤ì§€ ë¶ˆëŸ¬ì˜¤ê¸°\n",
                "\n",
                "ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ ì‚¬ìš©í•  RíŒ¨í‚¤ì§€ë“¤ì„ ë¶ˆëŸ¬ì˜¤ì. íŠ¹íˆ ìš”ì¦˜ í•«í•˜ë”” í•«í•œ `tidymodels` ì‚¬ìš©í•˜ì—¬ ì›”ë§ˆíŠ¸ ëŒ€íšŒë¥¼ ê°€ì§€ê³  ë†€ì•„ë³¸ë‹¤. ë˜í•œ ë§ˆì´ ë¹¼ì´ë³´ë¦¿ ì—°ì‚°ìë“¤ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•˜ì—¬ `magrittr`ë¥¼ ë¶ˆëŸ¬ì™”ë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "suppressMessages(library(magrittr))\n",
                "suppressMessages(library(tidymodels)) %>% suppressWarnings()\n",
                "suppressMessages(library(tidyverse)) %>% suppressWarnings()\n",
                "suppressMessages(library(skimr)) %>% suppressWarnings()\n",
                "suppressMessages(library(knitr)) %>% suppressWarnings()\n",
                "theme_set(theme_bw())\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## ë°ì´í„°ì…‹ ë¶ˆëŸ¬ì˜¤ê¸°\n",
                "\n",
                "ì´ ëŒ€íšŒì—ì„œ ì£¼ì–´ì§„ ë°ì´í„°ì…‹ì„ ë¶ˆëŸ¬ë³´ì. ì£¼ì–´ì§„ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "file_path <- \"../input/daconcredit14/\"\n",
                "files <- list.files(file_path)\n",
                "files\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ê° ë³€ìˆ˜ì˜ ì´ë¦„ì„ `janitor` íŒ¨í‚¤ì§€ë¡œ ë§ë”í•˜ê²Œ ë°”ê¿”ì¤€ë‹¤.\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "train <- read_csv(file.path(file_path, \"train.csv\")) %T>% \n",
                "  suppressMessages() %>% \n",
                "  janitor::clean_names()\n",
                "test <- read_csv(file.path(file_path, \"test.csv\")) %T>%\n",
                "  suppressMessages() %>% \n",
                "  janitor::clean_names()\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# ë°ì´í„° ê¸°ë³¸ì •ë³´ í™•ì¸\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "train %>% \n",
                "  head() %>% \n",
                "  kable() %>% \n",
                "  kableExtra::kable_styling(\"striped\") %>% \n",
                "  kableExtra::scroll_box(width = \"100%\")\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## ê¸°ë³¸ ì •ë³´\n",
                "\n",
                "ì´ ëŒ€íšŒëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ê°„ë‹¨í•œ ëŒ€íšŒì´ë‹¤. ì²«ë²ˆì§¸ ìŠ¤í„°ë””ìš© ëŒ€íšŒë¡œ ì„ íƒì„ í•œ ì´ìœ ì´ê¸°ë„ í•˜ë‹¤. ì£¼ ë°ì´í„°ëŠ” 2ë§Œ 6ì²œê°œì˜ train í‘œë³¸ê³¼ 1ë§Œê°œì˜ test í‘œë³¸ë“¤ë¡œ êµ¬ì„±ì´ ë˜ì–´ìˆë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "dim(train)\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "dim(test)\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ê° ë°ì´í„° ì…‹ì˜ ë³€ìˆ˜ëª…ì„ ì‚´í´ë³´ì. \n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "names(train)\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "names(test)\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ë¨¼ì € `test` ë°ì´í„°ì—ëŠ” ìš°ë¦¬ê°€ ì˜ˆì¸¡í•˜ê³  ì‹¶ì€ ë³€ìˆ˜ì¸ `credit` ë³€ìˆ˜ê°€ ë“¤ì–´ìˆì§€ ì•Šì€ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. \n",
                "\n",
                "ë°ì´í„°ë¥¼ í›‘ì–´ë³´ê¸° ìœ„í•´ì„œ `skim()` í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì. ì´ í•¨ìˆ˜ëŠ” ë°ì´í„°ì— ë“¤ì–´ìˆëŠ” ë³€ìˆ˜ë“¤ì„ íƒ€ì… ë³„ë¡œ ë¶„ì„í•´ì„œ ë¦¬í¬íŠ¸ë¥¼ ì‘ì„±í•´ì¤€ë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "skim(train)\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ê²°ê³¼ë¥¼ ì‚´í´ë³´ì. ë¨¼ì € ê²°ì¸¡ì¹˜ê°€ ìƒëŒ€ì ìœ¼ë¡œ ë§ì´ ì—†ëŠ” ì°©í•œ? ë°ì´í„°ì´ë‹¤. character ë³€ìˆ˜ì˜ complete rateë¥¼ ì‚´í´ë³´ë©´ ëª¨ë“  ë³€ìˆ˜ê°€ 1ì´ê³ , `occyp_type` ë³€ìˆ˜ë§Œì´ ê²°ì¸¡ì¹˜ê°€ 8171ê°œê°€ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë˜í•œ ê³ ë§™ê²Œë„ numeric ë³€ìˆ˜ì˜ ê²°ì¸¡ì¹˜ëŠ” í•˜ë‚˜ë„ ì—†ë‹¤!ğŸ˜†\n",
                "\n",
                "ê°™ì€ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ `test` ì…‹ì„ ë³´ë©´ ë˜‘ê°™ì€ íŒ¨í„´ì„ ê°€ì§€ê³  ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "skim(test)\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# ì‹œê°í™”\n",
                "\n",
                "ë² ì´ìŠ¤ ë¼ì¸ì„ ì¡ì€ ë¬¸ì„œì´ë‹ˆ ê°„ë‹¨í•˜ê²Œ ì‹œê°í™” í•˜ë‚˜ë§Œ í•˜ê³  ë„˜ì–´ê°€ì. (ì½”ë“œë¥¼ ì‘ìš©í•´ì„œ ë‹¤ë¥¸ ë³€ìˆ˜ì— ëŒ€í•œ ìƒê´€ ê´€ê³„ë¥¼ ë³¼ ìˆ˜ ìˆì„ ê²ƒì´ë‹¤.)\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "train %>%\n",
                "  ggplot(aes(x = factor(credit), y = income_total)) +\n",
                "  geom_boxplot() +\n",
                "  facet_grid(. ~ income_type)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ëª©í‘œ ë³€ìˆ˜ì¸ creditì€ ë‚®ì„ ìˆ˜ë¡ ë†’ì€ ì‹ ìš©ì˜ ì‹ ìš©ì¹´ë“œ ì‚¬ìš©ìë¥¼ ì˜ë¯¸ í•œë‹¤ê³  í•œë‹¤. Commercial associate ì¸ ê²½ìš° ì‹ ìš©ì´ ì œì¼ ë‚®ì€ ê·¸ë£¹ì˜ ìˆ˜ì…ì˜ ì¤‘ì•™ê°’ì´ ì œì¼ ë†’ë‹¤. ëˆì„ ë§ì´ ë²Œìˆ˜ë¡ ëˆ ê°šì€ ê°œë…ì´ ì—†ì–´ì§€ëŠ” ê²ƒì¸ê°€? ì¬ë¯¸ìˆëŠ” í˜„ìƒì´ë‹¤. í•™ìƒ í´ë˜ìŠ¤ì˜ ê²½ìš° train ë°ì´í„°ì— ì…‹ì´ ë§ì´ ì—†ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì¶”í›„ì— ë‹¤ë¥¸ í´ë˜ìŠ¤ë¡œ í†µí•©ì„ ì‹œí‚¤ëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒì´ë‹¤.\n",
                "\n",
                "# ì „ì²˜ë¦¬ í•˜ê¸°\n",
                "\n",
                "`tidymodels`ì—ì„œëŠ” ì „ì²˜ë¦¬ë¥¼ í•  ë•Œ `recipe` ë¼ëŠ” íŒ¨í‚¤ì§€ë¥¼ ì‚¬ìš©í•œë‹¤. ì´ íŒ¨í‚¤ì§€ì—ëŠ” ì „ì²˜ë¦¬ë¥¼ í•˜ëŠ” ë°©ë²•ì„ ìŒì‹ ë ˆí”¼ì‹œ ì²˜ëŸ¼ ì ì–´ë†“ëŠ”ë‹¤ê³  ìƒê°í•˜ë©´ ì‰½ë‹¤.\n",
                "\n",
                "## all_data ë¬¶ê¸°\n",
                "\n",
                "ì•ìœ¼ë¡œ ì „ì²˜ë¦¬ë¥¼ í•  ë•Œ ì¢€ ë” í¸ë¦¬í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œ `all_data`ë¡œ ë¬¶ì–´ë‚´ë„ë¡ í•˜ì.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "all_data <- bind_rows(train, test)\n",
                "all_data %>% dim()\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## ì „ì²˜ë¦¬ ì‚¬í•­ë“¤\n",
                "\n",
                "* ê²°ê³¼ê°’ì¸ credit ë³€ìˆ˜ì™€ character íƒ€ì…ì˜ ë³€ìˆ˜ë“¤ì„ factor ë³€ìˆ˜ë¡œ ë°”ê¿”ì£¼ì.\n",
                "* ë‚˜ì´ì™€ ì§ì—…ì„ ê°€ì§„ ê¸°ê°„ì„ ë…„ìˆ˜ë¡œ ë°”ê¿”ì¤€ë‹¤.\n",
                "\n",
                "## `recipe`ë¥¼ í†µí•œ ì „ì²˜ë¦¬ ì…ë ¥\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "credit_recipe <- all_data %>% \n",
                "  recipe(credit ~ .) %>% \n",
                "  step_mutate(credit = as.factor(credit)) %>% \n",
                "  # age and employment period in yrs\n",
                "  step_mutate(yrs_birth = -ceiling(days_birth/365),\n",
                "              yrs_employed = -ceiling(days_employed/356)) %>% \n",
                "  step_rm(index, days_birth, days_employed) %>%\n",
                "  step_unknown(occyp_type) %>% \n",
                "  step_integer(all_nominal(), -all_outcomes()) %>% \n",
                "  step_center(all_predictors(), -all_outcomes()) %>% \n",
                "  prep(training = all_data)\n",
                "\n",
                "print(credit_recipe)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## `juice`ë¥¼ í†µí•œ ì „ì²˜ë¦¬ ì¦™ì§œê¸°\n",
                "\n",
                "`juice()` í•¨ìˆ˜ë¥¼ í†µí•´ì„œ recipeì— ì…ë ¥ëœ ì „ì²˜ë¦¬ë¥¼ ì§œë‚¸ ë°ì´í„°ë¥¼ ì–»ì–´ì˜¨ë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "all_data2 <- juice(credit_recipe)\n",
                "head(all_data2)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ë‹¤ìŒê³¼ ê°™ì´ ê²°ì¸¡ì¹˜ ì—†ì´ ì˜ ì½”ë”©ëœ ë°ì´í„°ë¥¼ ì–»ì—ˆë‹¤ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "all_data2 %>%\n",
                "map_df(~sum(is.na(.))) %>%\n",
                "  pivot_longer(cols = everything(),\n",
                "       names_to = \"variable\",\n",
                "       values_to = \"na_count\") %>% \n",
                "  filter(na_count > 0)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "ì „ì²˜ë¦¬ê°€ ëë‚¬ìœ¼ë¯€ë¡œ, trainê³¼ testì…‹ì„ ë‚˜ëˆˆë‹¤.\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "train_index <- seq_len(nrow(train))\n",
                "train2 <- all_data2[train_index,]\n",
                "test2 <- all_data2[-train_index,]\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# íŠœë‹ ì¤€ë¹„í•˜ê¸°\n",
                "\n",
                "`validation_split()` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ í‰ê°€ì…‹ì„ ë¶„ë¦¬í•œë‹¤. í•œ ë‹¨ê³„ ë” ë‚˜ì•„ê°„ cross validationì€ `vfold_cv()`í•¨ìˆ˜ì—ì„œ ì œê³µí•˜ë‹ˆ ì°¾ì•„ë³´ë„ë¡ í•˜ì.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "set.seed(2021)\n",
                "\n",
                "validation_split <- validation_split(train2, prop = 0.7, \n",
                "                                     strata = credit)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## íŠœë‹ ìŠ¤í™ ì„¤ì •\n",
                "\n",
                "ëœë¤ í¬ë ˆìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•  ê²ƒì´ê³ , mtryì™€ min_nì„ ì–´ë–»ê²Œ ì •í• ì§€ë¥¼ í‰ê°€ì…‹ì„ í†µí•´ì„œ ê²°ì •í•  ê²ƒì´ë¯€ë¡œ, `tune()`ë¥¼ ì‚¬ìš©í•´ì„œ tidymodelsì—ê²Œ ì•Œë ¤ì£¼ë„ë¡ í•œë‹¤.\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "cores <- parallel::detectCores() -1\n",
                "cores\n",
                "\n",
                "tune_spec <- rand_forest(mtry = tune(),\n",
                "                         min_n = tune(),\n",
                "                         trees = 1000) %>% \n",
                "    set_engine(\"ranger\",\n",
                "               num.threads = cores) %>% \n",
                "    set_mode(\"classification\")\n",
                "\n",
                "# param_grid <- grid_latin_hypercube(finalize(mtry(), x = train2[,-1]),\n",
                "#                                    min_n(), size = 100)\n",
                "\n",
                "# from param tune\n",
                "param_grid <- tibble(mtry = 3, min_n = 5)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "## ì›Œí¬ í”Œë¡œìš° ì„¤ì •\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "workflow <- workflow() %>%\n",
                "  add_model(tune_spec) %>% \n",
                "  add_formula(credit ~ .)\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# ëª¨ë¸ íŠœë‹ with tune_grid()\n",
                "\n",
                "# Tuning trees\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "library(tictoc)\n",
                "tic()\n",
                "tune_result <- workflow %>% \n",
                "  tune_grid(validation_split,\n",
                "            grid = param_grid,\n",
                "            metrics = metric_set(mn_log_loss))\n",
                "toc()\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "tune_result$.notes\n",
                "tune_result %>% \n",
                "  collect_metrics()\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# íŠœë‹ê²°ê³¼ ì‹œê°í™”\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "tune_result %>%\n",
                "  collect_metrics() %>%\n",
                "  filter(.metric == \"mn_log_loss\") %>% \n",
                "  ggplot(aes(mtry, mean, color = .metric)) +\n",
                "  geom_line(size = 1.5) +\n",
                "  scale_x_log10() +\n",
                "  theme(legend.position = \"none\") +\n",
                "  labs(title = \"Mean Log loss\")\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "tune_result %>% show_best()\n",
                "\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "tune_best <- tune_result %>% select_best(metric = \"mn_log_loss\")\n",
                "tune_best$mtry\n",
                "tune_best$min_n\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# íŠœë‹ëœ ëª¨ë¸ í•™ìŠµí•˜ê¸°\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "rf_model <- \n",
                "  rand_forest(mtry = tune_best$mtry,\n",
                "              min_n = tune_best$min_n,\n",
                "              trees = 1000) %>% \n",
                "    set_engine(\"ranger\", seed = 2021, \n",
                "               num.threads = cores) %>% \n",
                "    set_mode(\"classification\")\n",
                "\n",
                "tictoc::tic()\n",
                "rf_fit <- \n",
                "    rf_model %>% \n",
                "    fit(credit ~ ., data = train2)\n",
                "tictoc::toc()\n",
                "\n",
                "options(max.print = 10)\n",
                "rf_fit\n",
                "# Ranger result\n",
                "# \n",
                "# Type:                             Probability estimation \n",
                "# Number of trees:                  1000 \n",
                "# Sample size:                      26457 \n",
                "# Number of independent variables:  18 \n",
                "# Mtry:                             3 \n",
                "# Target node size:                 5 \n",
                "# Variable importance mode:         none \n",
                "# Splitrule:                        gini \n",
                "# OOB prediction error (Brier s.):  0.2308023 \n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": [
                "# ì˜ˆì¸¡í•˜ê¸°\n",
                "\n"
            ]
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "result <- predict(rf_fit, test2, type = \"prob\")\n",
                "result %>% head()\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        },
        {
            "cell_type": "code",
            "execution_count": null,
            "metadata": {},
            "outputs": [],
            "source": [
                "submission <- read_csv(file.path(file_path, \"sample_submission.csv\"))\n",
                "sub_col <- names(submission)\n",
                "submission <- bind_cols(submission$index, result)\n",
                "names(submission) <- sub_col\n",
                "write.csv(submission, row.names = FALSE,\n",
                "          \"baseline_dacon_credit.csv\")\n"
            ]
        },
        {
            "cell_type": "markdown",
            "metadata": {},
            "source": "\n"
        }
    ],
    "metadata": {
        "anaconda-cloud": "",
        "kernelspec": {
            "display_name": "R",
            "langauge": "R",
            "name": "ir"
        },
        "language_info": {
            "codemirror_mode": "r",
            "file_extension": ".r",
            "mimetype": "text/x-r-source",
            "name": "R",
            "pygments_lexer": "r",
            "version": "3.4.1"
        }
    },
    "nbformat": 4,
    "nbformat_minor": 1
}
